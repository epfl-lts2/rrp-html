 
<!DOCTYPE html>
<html lang="en">
<head class="include" file="../include/header.html">
<link rel="stylesheet" href="../include/bootstrap.min.css">
<link rel="stylesheet" href="../include/bootstrap-theme.min.css">
<link rel="stylesheet" href="../include/bootstrap-select.min.css">
<link rel="stylesheet" href="../include/style.css" type="text/css">
<link rel="stylesheet" href="../include/highlight.css" type="text/css">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta NAME="keywords" CONTENT="reproducible, research, platform, rrp, rr, reproducible research, reproducible research platform, matlab, code, mat2doc, science, knowledge"/>

<title>ADAPTATED_SAMPLING - Adaptation of the sampling according to local uncertainy</title>
</head>



<!-- body must stay hidden until all include parts are loaded -->
<body style="display:none;">
<!-- Wrap the content into responsive container -->
<div class="container">
<!-- Include main navigation -->
    <div class="masthead include" file="../include/mainnav.html"></div>
        <div class="row">
            <div class="col-md-2" id="codeswitch"><div id="menutitle"><a href="adaptated_sampling.html">View the help</a></div>
</div>
            <div class="btn btn-large btn-success span22-doc">
                <a style="color: #FFFFFF" href="../archive/#PACKAGE#.zip">Download <font color="red">r<sup>2</sup>&pi;</font> archive for windows</a>
                <a style="color: #FFFFFF" href="../archive/#PACKAGE#.tgz"> or for unix </a> 
            </div>
        </div>
        <div class="row">
            <div class="col-md-2">
                <div class="include" file='contentsmenu.html'></div>
                <br/>
                <div id="seealso"><p></p></div>
                <br/>
            </div>
            <div class="col-md-10">
           
                    <h1 class="title">ADAPTATED_SAMPLING - Adaptation of the sampling according to local uncertainy</h1>
<h2>Program code:</h2>
<div class="highlight"><pre><span></span><span class="c">%ADAPTATED_SAMPLING Adaptation of the sampling according to local uncertainy</span>
<span class="c">%</span>
<span class="c">%   This package contains the code to reproduce all the figures of the</span>
<span class="c">%   paper: </span>
<span class="c">%   </span>
<span class="c">%   Global and Local Uncertainty Principles for Signals on Graphs</span>
<span class="c">%</span>
<span class="c">%   Authors: Nathanael Perraudin, Benjamin Ricaud, David I Shuman, Pierre</span>
<span class="c">%   Vandergheynst </span>
<span class="c">%</span>
<span class="c">%   ArXiv: http://arxiv.org/abs/1603.03030</span>
<span class="c">%</span>
<span class="c">%   Abstract of the paper</span>
<span class="c">%   ---------------------</span>
<span class="c">%</span>
<span class="c">%   Uncertainty principles such as Heisenberg&#39;s provide limits on the</span>
<span class="c">%   time-frequency concentration of a signal, and constitute an important</span>
<span class="c">%   theoretical tool for designing and evaluating linear signal transforms.</span>
<span class="c">%   Generalizations of such principles to the graph setting can inform</span>
<span class="c">%   dictionary design for graph signals, lead to algorithms for</span>
<span class="c">%   reconstructing missing information from graph signals via sparse</span>
<span class="c">%   representations, and yield new graph analysis tools. While previous</span>
<span class="c">%   work has focused on generalizing notions of spreads of a graph signal</span>
<span class="c">%   in the vertex and graph spectral domains, our approach is to generalize</span>
<span class="c">%   the methods of Lieb in order to develop uncertainty principles that</span>
<span class="c">%   provide limits on the concentration of the analysis coefficients of any</span>
<span class="c">%   graph signal under a dictionary transform whose atoms are jointly</span>
<span class="c">%   localized in the vertex and graph spectral domains. One challenge we</span>
<span class="c">%   highlight is that due to the inhomogeneity of the underlying graph data</span>
<span class="c">%   domain, the local structure in a single small region of the graph can</span>
<span class="c">%   drastically affect the uncertainty bounds for signals concentrated in</span>
<span class="c">%   different regions of the graph, limiting the information provided by</span>
<span class="c">%   global uncertainty principles. Accordingly, we suggest a new way to</span>
<span class="c">%   incorporate a notion of locality, and develop local uncertainty</span>
<span class="c">%   principles that bound the concentration of the analysis coefficients of</span>
<span class="c">%   each atom of a localized graph spectral filter frame in terms of</span>
<span class="c">%   quantities that depend on the local structure of the graph around the</span>
<span class="c">%   center vertex of the given atom. Finally, we demonstrate how our</span>
<span class="c">%   proposed local uncertainty measures can improve the random sampling of</span>
<span class="c">%   graph signals.</span>
<span class="c">%</span>
<span class="c">%   This experiment</span>
<span class="c">%   ---------------</span>
<span class="c">%</span>
<span class="c">%   In order to motivate our uncertainty Theorem from a practical signal</span>
<span class="c">%   processing point of view, we use it to optimize the sampling of a</span>
<span class="c">%   signal over a graph. To asses the quality of the sampling, we solve a</span>
<span class="c">%   small inpainting problem where only a part of a signal is measured and</span>
<span class="c">%   the goal is to reconstruct the entire signal. Assuming that the signal</span>
<span class="c">%   varies smoothly in the vertex domain, we can formulate the inverse</span>
<span class="c">%   problem as:</span>
<span class="c">%</span>
<span class="c">%      argmin_x  x^T L x      s. t.    y = Mx,</span>
<span class="c">%</span>
<span class="c">%   where y is the observed signal, M the inpainting masking operator</span>
<span class="c">%   and x^T L x the graph Tikhonov regularizer (L being the</span>
<span class="c">%   Laplacian). In order to generate the original signal, we filter</span>
<span class="c">%   Gaussian noise on the graph with a low pass kernel hat{h}. The</span>
<span class="c">%   frequency content of the resulting signal will be close to the shape of</span>
<span class="c">%   the filter hat{h}. For this example, we use the low pass kernel</span>
<span class="c">%   hat{h}(x) = frac{1}{1+frac{100}{lambda_{max}} x} to generate the</span>
<span class="c">%   smooth signal.</span>
<span class="c">%</span>
<span class="c">%   For a given number of measurements, the traditional idea is to randomly</span>
<span class="c">%   sample the graph. Under that strategy, the measurements are distributed</span>
<span class="c">%   across the network. Alternatively, we can use our local uncertainty</span>
<span class="c">%   principles to create an adapted mask. The intuitive idea that nodes</span>
<span class="c">%   with less uncertainty (higher local sparsity values) should be sampled</span>
<span class="c">%   with higher probability because their value can be inferred less easily</span>
<span class="c">%   from other nodes. Another way to picture this fact is the following.</span>
<span class="c">%   Imagine that we want to infer a quantity over a random sensor network.</span>
<span class="c">%   In the more densely populated parts of the network, the measurements</span>
<span class="c">%   are more correlated and redundant. As result, a lower sampling rate is</span>
<span class="c">%   necessary. On the contrary, in the parts where there are fewer sensors,</span>
<span class="c">%   the information has less redundancy and a higher sampling rate is</span>
<span class="c">%   necessary. The heat kernel hat{g}(x)=e^{-tau x} is a convenient</span>
<span class="c">%   choice to probe the local uncertainty of a graph, because</span>
<span class="c">%   hat{g}^{2}(x)=e^{-2tau~x} is also a heat kernel, resulting in a</span>
<span class="c">%   sparsity level depending only on T_{J}G^{2}_{2}. Indeed we have</span>
<span class="c">%   T_{j}g^{2}||_{1}=sqrt{N}. The local uncertainty bound of our</span>
<span class="c">%   Theorem becomes:</span>
<span class="c">%</span>
<span class="c">%      O_{1}(j)= || T_j g^2 ||_1 / || T_j g^2 ||_2 = </span>
<span class="c">%              = \sqrt{N} / || T_j g^2 ||_2.</span>
<span class="c">%</span>
<span class="c">%   Based on this measure, we design a second random sampled mask with a</span>
<span class="c">%   probability proportional to T_ig^2||_2; that is, the higher the</span>
<span class="c">%   overlap level at vertex j, the smaller the probability that vertex</span>
<span class="c">%   j is chosen as a sampling point, and vice-versa. For each sampling</span>
<span class="c">%   ratio, we performed 100 experiments and averaged the results. For</span>
<span class="c">%   each experiment, we also randomly generated new graphs. The experiment</span>
<span class="c">%   was carried out using open-source code: the UNLocBoX and the GSPBox.</span>
<span class="c">%</span>
<span class="c">%   For the sensor graph, we observe that our local measure of uncertainty</span>
<span class="c">%   varies smoothly on the graph and is higher in the more dense part.</span>
<span class="c">%   Thus, the likelihood of sampling poorly connected vertices is higher</span>
<span class="c">%   than the likelihood of sampling well connected vertices. For the</span>
<span class="c">%   community graph, we observe that the uncertainty is highly related to</span>
<span class="c">%   the size of the community. The larger the community, the larger the</span>
<span class="c">%   uncertainty (or, equivalently, the smaller the local sparsity value).</span>
<span class="c">%   In both cases, the adapted, non-uniform random sampling performs better</span>
<span class="c">%   than random uniform sampling.</span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">%   Figure 1: Reconstructions resulting</span>
<span class="c">%</span>
<span class="c">%      Non uniform sampling performs better</span>
<span class="c">%</span>
<span class="c">%   Figure 2: Local uncertainty</span>
<span class="c">%</span>
<span class="c">%      The local uncertainty is inversly proportional to T_i g||_2.</span>
<span class="c">%  </span>
<span class="c">%   Figure 3: Norm of the atoms</span>
<span class="c">%</span>
<span class="c">%      The random non-uniform sampling distribution is proportional to</span>
<span class="c">%      T_i g||_2.</span>
<span class="c">%</span>
<span class="c">%   </span>
<span class="c">%   References:</span>
<span class="c">%     N. Perraudin, R. Benjamin, S. David I, and P. Vandergheynst. Global and</span>
<span class="c">%     local uncertainty principles for signals on graphs. arXiv preprint</span>
<span class="c">%     arXiv:1603.03030, 2016.</span>
<span class="c">%     </span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">%   Url: https://epfl-lts2.github.io/rrp-html/uncertainty/adaptated_sampling.html</span>

<span class="c">% Copyright (C) 2012-2013 Nathanael Perraudin.</span>
<span class="c">% This file is part of RRP version 0.2</span>
<span class="c">%</span>
<span class="c">% This program is free software: you can redistribute it and/or modify</span>
<span class="c">% it under the terms of the GNU General Public License as published by</span>
<span class="c">% the Free Software Foundation, either version 3 of the License, or</span>
<span class="c">% (at your option) any later version.</span>
<span class="c">%</span>
<span class="c">% This program is distributed in the hope that it will be useful,</span>
<span class="c">% but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c">% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c">% GNU General Public License for more details.</span>
<span class="c">%</span>
<span class="c">% You should have received a copy of the GNU General Public License</span>
<span class="c">% along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>



<span class="c">%% Initialisation</span>
<span class="n">clear</span><span class="p">;</span>
<span class="n">close</span> <span class="n">all</span><span class="p">;</span>

<span class="k">global</span> <span class="n">SAVE</span><span class="p">;</span>
<span class="k">global</span> <span class="n">type</span><span class="p">;</span>

<span class="c">% plotting paramter</span>
<span class="n">paramplot</span><span class="p">.</span><span class="n">save</span> <span class="p">=</span> <span class="n">SAVE</span><span class="p">;</span>
<span class="n">paramplot</span><span class="p">.</span><span class="n">savefig</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="n">paramplot</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">100</span> <span class="mi">300</span> <span class="mi">220</span><span class="p">];</span>
<span class="n">gsp_reset_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c">%% Parameter</span>


<span class="n">N</span> <span class="p">=</span> <span class="mi">300</span><span class="p">;</span>
<span class="n">Ntest</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">Ns</span> <span class="p">=</span> <span class="mi">20</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">200</span><span class="p">;</span> 
<span class="n">Nsmax</span> <span class="p">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Ns</span><span class="p">);</span>
<span class="n">h</span> <span class="p">=</span> <span class="p">@(</span><span class="n">G</span><span class="p">)</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">100</span><span class="o">/</span><span class="n">G</span><span class="p">.</span><span class="n">lmax</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
<span class="k">if</span> <span class="o">~</span><span class="nb">numel</span><span class="p">(</span><span class="n">type</span><span class="p">)</span>
    <span class="n">type</span> <span class="p">=</span> <span class="s">&#39;community&#39;</span><span class="p">;</span> <span class="c">% or sensor</span>
<span class="k">end</span>
<span class="c">%%</span>
<span class="n">error1</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">Ntest</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">Ns</span><span class="p">));</span>
<span class="n">error2</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">Ntest</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">Ns</span><span class="p">));</span>


<span class="c">%%</span>
<span class="k">for</span> <span class="n">ii</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">Ntest</span>

    <span class="k">switch</span> <span class="n">type</span>
        <span class="k">case</span> <span class="s">&#39;community&#39;</span>    
            <span class="n">G</span> <span class="p">=</span> <span class="n">gsp_community</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">case</span> <span class="s">&#39;sensor&#39;</span>
            <span class="n">G</span> <span class="p">=</span> <span class="n">gsp_sensor</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">otherwise</span>
            <span class="n">error</span><span class="p">(</span><span class="s">&#39;Unknown type of graph&#39;</span><span class="p">)</span>
    <span class="k">end</span>

   <span class="n">G</span> <span class="p">=</span> <span class="n">gsp_estimate_lmax</span><span class="p">(</span><span class="n">G</span><span class="p">);</span>


    <span class="n">g</span> <span class="p">=</span> <span class="n">gsp_design_heat</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
      <span class="n">ntig</span> <span class="p">=</span> <span class="n">gsp_norm_tig</span><span class="p">(</span><span class="n">G</span><span class="p">,@(</span><span class="n">x</span><span class="p">)</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>

    <span class="c">% Perform the sampling</span>
    <span class="n">sample_non_uniform</span> <span class="p">=</span> <span class="n">randsampleWRW</span><span class="p">((</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">),</span><span class="n">Nsmax</span><span class="p">,</span><span class="n">ntig</span><span class="p">);</span>    
    <span class="n">sample_uniform</span> <span class="p">=</span> <span class="n">randsample</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Nsmax</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

    <span class="n">s</span> <span class="p">=</span> <span class="n">gsp_filter_analysis</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="n">G</span><span class="p">),</span><span class="nb">randn</span><span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
    <span class="k">for</span> <span class="n">jj</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">Ns</span><span class="p">);</span>
        <span class="c">% Create the masks</span>
        <span class="n">mask_non_uniform</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">mask_non_uniform</span><span class="p">(</span><span class="n">sample_non_uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Ns</span><span class="p">(</span><span class="n">jj</span><span class="p">)))</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">mask_uniform</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">mask_uniform</span><span class="p">(</span><span class="n">sample_uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Ns</span><span class="p">(</span><span class="n">jj</span><span class="p">)))</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
        
        <span class="c">% Input signals</span>
        <span class="n">y1</span> <span class="p">=</span> <span class="n">mask_non_uniform</span> <span class="o">.*</span> <span class="n">s</span><span class="p">;</span>
        <span class="n">y2</span> <span class="p">=</span> <span class="n">mask_uniform</span> <span class="o">.*</span> <span class="n">s</span><span class="p">;</span>

        <span class="n">param</span> <span class="p">=</span> <span class="n">struct</span><span class="p">;</span>
        <span class="n">param</span><span class="p">.</span><span class="n">verbose</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">param</span><span class="p">.</span><span class="n">exact</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
        
        <span class="c">% Solve the problem</span>
        <span class="n">sol_non_uniform</span> <span class="p">=</span> <span class="n">gsp_regression_tik</span><span class="p">(</span><span class="n">G</span> <span class="p">,</span><span class="n">mask_non_uniform</span><span class="p">,</span> <span class="n">y1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="p">);</span>
        <span class="n">sol_uniform</span> <span class="p">=</span> <span class="n">gsp_regression_tik</span><span class="p">(</span><span class="n">G</span> <span class="p">,</span><span class="n">mask_uniform</span><span class="p">,</span> <span class="n">y2</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="p">);</span>

<span class="c">%         sol1 = y1;</span>
<span class="c">%         sol1(logical(1-mask1)) = sol1_m;</span>
<span class="c">%         sol2 = y2;</span>
<span class="c">%         sol2(logical(1-mask2)) = sol2_m;</span>

        <span class="n">error1</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span> <span class="p">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">sol_non_uniform</span><span class="o">-</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
        <span class="n">error2</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">)</span> <span class="p">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">sol_uniform</span><span class="o">-</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

    <span class="k">end</span>

<span class="k">end</span>

<span class="c">%%</span>

<span class="k">switch</span> <span class="n">G</span><span class="p">.</span><span class="n">type</span>
    <span class="k">case</span> <span class="s">&#39;sensor&#39;</span>
        <span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">Ns</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span><span class="s">&#39;rx-&#39;</span><span class="p">,</span><span class="n">Ns</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span><span class="s">&#39;bx-&#39;</span><span class="p">)</span>
        <span class="n">legend</span><span class="p">(</span><span class="s">&#39;Adapted sampling&#39;</span><span class="p">,</span><span class="s">&#39;Random sampling&#39;</span><span class="p">)</span>
        <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Number of measurements&#39;</span><span class="p">)</span>
        <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Relative recovery error&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Sensor graph - Overlap level&#39;</span><span class="p">)</span>
        <span class="k">end</span>
        
        <span class="n">gsp_reset_seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">Nsf</span> <span class="p">=</span> <span class="mi">50</span><span class="p">;</span>
        <span class="n">clear</span> <span class="n">G</span>
        <span class="n">G</span> <span class="p">=</span> <span class="n">gsp_sensor</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="n">G</span> <span class="p">=</span> <span class="n">gsp_estimate_lmax</span><span class="p">(</span><span class="n">G</span><span class="p">);</span>
        <span class="n">g</span> <span class="p">=</span> <span class="n">gsp_design_heat</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
        <span class="n">ntig</span> <span class="p">=</span> <span class="n">gsp_norm_tig</span><span class="p">(</span><span class="n">G</span><span class="p">,@(</span><span class="n">x</span><span class="p">)</span> <span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
        
        <span class="c">% Perform an aditional experiment</span>
        <span class="c">% Perform the sampling</span>
        <span class="n">sample_non_uniform</span> <span class="p">=</span> <span class="n">randsampleWRW</span><span class="p">((</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">),</span><span class="n">Nsmax</span><span class="p">,</span><span class="n">ntig</span><span class="p">);</span>    
        <span class="n">sample_uniform</span> <span class="p">=</span> <span class="n">randsample</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Nsmax</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

        <span class="n">s</span> <span class="p">=</span> <span class="n">gsp_filter_analysis</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="n">G</span><span class="p">),</span><span class="nb">randn</span><span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>

        <span class="c">% Create the masks</span>
        <span class="n">mask_non_uniform</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">mask_non_uniform</span><span class="p">(</span><span class="n">sample_non_uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Nsf</span><span class="p">))</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">mask_uniform</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">mask_uniform</span><span class="p">(</span><span class="n">sample_uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Nsf</span><span class="p">))</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

        <span class="c">% Input signals</span>
        <span class="n">y1</span> <span class="p">=</span> <span class="n">mask_non_uniform</span> <span class="o">.*</span> <span class="n">s</span><span class="p">;</span>
        <span class="n">y2</span> <span class="p">=</span> <span class="n">mask_uniform</span> <span class="o">.*</span> <span class="n">s</span><span class="p">;</span>

        <span class="n">param</span> <span class="p">=</span> <span class="n">struct</span><span class="p">;</span>
        <span class="n">param</span><span class="p">.</span><span class="n">verbose</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">param</span><span class="p">.</span><span class="n">exact</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

        <span class="c">% Solve the problem</span>
        <span class="n">sol_non_uniform</span> <span class="p">=</span> <span class="n">gsp_regression_tik</span><span class="p">(</span><span class="n">G</span> <span class="p">,</span><span class="n">mask_non_uniform</span><span class="p">,</span> <span class="n">y1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="p">);</span>
        <span class="n">sol_uniform</span> <span class="p">=</span> <span class="n">gsp_regression_tik</span><span class="p">(</span><span class="n">G</span> <span class="p">,</span><span class="n">mask_uniform</span><span class="p">,</span> <span class="n">y2</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="p">);</span>
        
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;adapted_sampling_rel_error_sensor&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>
        <span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="n">ntig</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Sensor graph - Uncertainty/ O_1&#39;</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;adapted_sampling_uncertainty_sensor&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>
        
        <span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">ntig</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Sensor graph - ||T_ig||&#39;</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;adapted_sampling_sparsity_sensor&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>

        <span class="n">figure</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
        <span class="n">caxis</span><span class="p">([</span><span class="n">min</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">max</span><span class="p">(</span><span class="n">s</span><span class="p">)]);</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Original signal&#39;</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;single_experiment_adapted_ori&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>

        <span class="n">figure</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="c">% y2(logical(1-mask_non_uniform)) = min(y2);</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">mask_non_uniform</span><span class="p">)</span>
        <span class="c">% y1(logical(1-mask_uniform)) = min(y1);</span>
        <span class="c">% gsp_plot_signal(G,y1)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Mask adaptated sampling&#39;</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;single_experiment_adapted_mask&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>


        <span class="n">figure</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">mask_uniform</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Mask adaptated sampling&#39;</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;single_experiment_uniform_mask&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>

        <span class="n">figure</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">sol_uniform</span><span class="p">)</span>
        <span class="n">caxis</span><span class="p">([</span><span class="n">min</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">max</span><span class="p">(</span><span class="n">s</span><span class="p">)]);</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Uniform sampling reconstruction&#39;</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;single_experiment_adapted_rec_un&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>

        <span class="n">figure</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">sol_non_uniform</span><span class="p">)</span>
        <span class="n">caxis</span><span class="p">([</span><span class="n">min</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">max</span><span class="p">(</span><span class="n">s</span><span class="p">)]);</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Adaptated sampling reconstruction&#39;</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;single_experiment_adapted_rec_opt&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>

        
    <span class="k">case</span> <span class="s">&#39;community&#39;</span>

        <span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">Ns</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span><span class="s">&#39;rx-&#39;</span><span class="p">,</span><span class="n">Ns</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span><span class="s">&#39;bx-&#39;</span><span class="p">)</span>
        <span class="n">legend</span><span class="p">(</span><span class="s">&#39;Adapted sampling&#39;</span><span class="p">,</span><span class="s">&#39;Random sampling&#39;</span><span class="p">,</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;Best&#39;</span><span class="p">)</span>
        <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Number of measurements&#39;</span><span class="p">)</span>
        <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Relative recovery error&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Community graph - Error level&#39;</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;adapted_sampling_rel_error_cummunity&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>

        <span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="n">ntig</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Community graph - Uncertainty/O_1&#39;</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;adapted_sampling_uncertainty_cummunity&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>
        
        <span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">ntig</span><span class="p">)</span>
        <span class="k">if</span> <span class="o">~</span><span class="n">SAVE</span>
            <span class="n">title</span><span class="p">(</span><span class="s">&#39;Community graph - ||T_ig||&#39;</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">gsp_plotfig</span><span class="p">(</span><span class="s">&#39;adapted_sampling_sparsity_cummunity&#39;</span><span class="p">,</span><span class="n">paramplot</span><span class="p">)</span>


    <span class="k">otherwise</span>
        
        <span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">Ns</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span><span class="s">&#39;rx-&#39;</span><span class="p">,</span><span class="n">Ns</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span><span class="s">&#39;bx-&#39;</span><span class="p">)</span>
        <span class="n">legend</span><span class="p">(</span><span class="s">&#39;Adaptated sampling&#39;</span><span class="p">,</span><span class="s">&#39;Random sampling&#39;</span><span class="p">,</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;Best&#39;</span><span class="p">)</span>
        <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Number of measurements&#39;</span><span class="p">)</span>
        <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Relative recovery error&#39;</span><span class="p">)</span>


        <span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">gsp_plot_signal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="n">ntig</span><span class="p">)</span>
        <span class="n">title</span><span class="p">(</span><span class="s">&#39;Local uncertainty estimation&#39;</span><span class="p">)</span>
<span class="k">end</span>


<span class="c">%%</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Relative error adaptated sampling: %0.3f\n&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="p">(</span><span class="n">error1</span><span class="p">(:)));</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Relative error random sampling: %0.3f\n&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="p">(</span><span class="n">error2</span><span class="p">(:)));</span>
</pre></div>


            </div>
        </div>

        <div class="include" file="../include/footer.html"></div>
    </div>
</div>
<!-- These two have to be here to dynamically load the included parts -->
<script src="../include/jquery.min.js"></script>
<script src="../include/bootstrap-select.min.js"></script>
<script src="../include/rrp.js" type="text/javascript"></script>
</body>
</html>




