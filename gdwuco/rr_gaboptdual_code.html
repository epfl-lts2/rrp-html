 
<!DOCTYPE html>
<html lang="en">
<head class="include" file="../include/header.html">
<link rel="stylesheet" href="../include/bootstrap.min.css">
<link rel="stylesheet" href="../include/bootstrap-theme.min.css">
<link rel="stylesheet" href="../include/bootstrap-select.min.css">
<link rel="stylesheet" href="../include/style.css" type="text/css">
<link rel="stylesheet" href="../include/highlight.css" type="text/css">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta NAME="keywords" CONTENT="reproducible, research, platform, rrp, rr, reproducible research, reproducible research platform, matlab, code, mat2doc, science, knowledge"/>

<title>RR_GABOPTDUAL - Optimization of dual gabor windows</title>
</head>



<!-- body must stay hidden until all include parts are loaded -->
<body style="display:none;">
<!-- Wrap the content into responsive container -->
<div class="container">
<!-- Include main navigation -->
    <div class="masthead include" file="../include/mainnav.html"></div>
        <div class="row">
            <div class="col-md-2" id="codeswitch"><div id="menutitle"><a href="rr_gaboptdual.html">View the help</a></div>
</div>
            <div class="btn btn-large btn-success span22-doc">
                <a style="color: #FFFFFF" href="../archive/#PACKAGE#.zip">Download <font color="red">r<sup>2</sup>&pi;</font> archive for windows</a>
                <a style="color: #FFFFFF" href="../archive/#PACKAGE#.tgz"> or for unix </a> 
            </div>
        </div>
        <div class="row">
            <div class="col-md-2">
                <div class="include" file='contentsmenu.html'></div>
                <br/>
                <div id="seealso"><p></p></div>
                <br/>
            </div>
            <div class="col-md-10">
           
                    <h1 class="title">RR_GABOPTDUAL - Optimization of dual gabor windows</h1>
<h2>Program code:</h2>
<div class="highlight"><pre><span></span><span class="c">%RR_GABOPTDUAL Optimization of dual gabor windows</span>
<span class="c">%                           </span>
<span class="c">%   Reproducible research addendum for optimization of dual gabor windows</span>
<span class="c">%   ---------------------------------------------------------------------</span>
<span class="c">%   </span>
<span class="c">%   DESINGING GABOR WINDOWS USING CONVEX OPTIMIZATION</span>
<span class="c">%</span>
<span class="c">%   Paper: Nathanael Perraudin, Nicki Holighaus, Peter L. Sondergaard and</span>
<span class="c">%   Peter Balazs </span>
<span class="c">%   </span>
<span class="c">%   Demonstration matlab file:  Perraudin Nathanael</span>
<span class="c">%</span>
<span class="c">%   ARI -- January 2013</span>
<span class="c">%   </span>
<span class="c">%   Dependencies</span>
<span class="c">%   ------------</span>
<span class="c">%</span>
<span class="c">%   In order to use this matlab file you need the UNLocbox toolbox. You</span>
<span class="c">%   can download it on https://lts2research.epfl.ch/unlocbox and the LTFAT</span>
<span class="c">%   toolbox. You can download it on http://ltfat.sourceforge.net</span>
<span class="c">%</span>
<span class="c">%   You can also want the convergence of the algorithm at</span>
<span class="c">%   https://lts2research.epfl.ch/unlocbox/rr/gdwuco/gif.php.</span>
<span class="c">%</span>
<span class="c">%   Goal</span>
<span class="c">%   ----</span>
<span class="c">%</span>
<span class="c">%   We show the deference of different dual sythesis windows designed</span>
<span class="c">%   either by classic techniques or by convex optimization. </span>
<span class="c">%</span>
<span class="c">%   All the examples provided in this experiment were computed with an</span>
<span class="c">%   Itersine analysis window with L_g=60 L=240, a=15 and M=120,</span>
<span class="c">%   without support constraints. This setup, in particular its high</span>
<span class="c">%   redundancy, allows us to shape the dual windows rather freely for</span>
<span class="c">%   different objective functions, therefore producing characteristic</span>
<span class="c">%   examples. The window is shown below</span>
<span class="c">%</span>
<span class="c">%   Figure 1: Analysis window in time domain</span>
<span class="c">%</span>
<span class="c">%      The chosen windows is an itersine of length 60</span>
<span class="c">%</span>
<span class="c">%   Figure 2: Analysis window in frequency domain</span>
<span class="c">%</span>
<span class="c">%      </span>
<span class="c">%</span>
<span class="c">%   The canonical dual, equals the window up to scaling.  </span>
<span class="c">%</span>
<span class="c">%   Figure 3: Canonical dual window in time domain</span>
<span class="c">%</span>
<span class="c">%       </span>
<span class="c">%</span>
<span class="c">%   Figure 4: Canonical dual window in frequency domain</span>
<span class="c">%</span>
<span class="c">%      </span>
<span class="c">%</span>
<span class="c">%   To obtain different dual window than the canonical dual, we propose to</span>
<span class="c">%   solve a convex optimization problem of the form:</span>
<span class="c">%</span>
<span class="c">%      gd  = argmin_x    f(x)</span>
<span class="c">%</span>
<span class="c">%          such that    x is a dual windows of g and is compaclty supported</span>
<span class="c">%</span>
<span class="c">%   with </span>
<span class="c">%         - x         :  optimization variable</span>
<span class="c">%         - f(x)      :  functional to promote properties.</span>
<span class="c">%</span>
<span class="c">%   We compare several functions to be minimized. A list is presented here</span>
<span class="c">%   below. To obtained the best window, we may use several of them:</span>
<span class="c">%   </span>
<span class="c">%     nabla x _2^2  : force the windows to be smooth</span>
<span class="c">%   </span>
<span class="c">%     nabla F x _2^2: force the windows to be localized</span>
<span class="c">%</span>
<span class="c">%     x _2^2         : minimize the two norm of the synthesis windows</span>
<span class="c">%</span>
<span class="c">%     x _1           : minimize the one norm of the synthesis windows</span>
<span class="c">%</span>
<span class="c">%     F x _1         : minimize the one norm in frequencie of the windows</span>
<span class="c">%</span>
<span class="c">%     x - z _2^2     : Make x look like z in the 2 norm sense</span>
<span class="c">%</span>
<span class="c">%    var(x)              : Localize x in time</span>
<span class="c">%</span>
<span class="c">%    var(x^2)            : Localize x in time</span>
<span class="c">%</span>
<span class="c">%    var(F x)            : Localize x in frequency</span>
<span class="c">%</span>
<span class="c">%    var((F x)^2)        : Localize x in frequency</span>
<span class="c">%</span>
<span class="c">%   Solving the problem for each of these prior at once allows to produce</span>
<span class="c">%   characteristic example to illustrate our technique</span>
<span class="c">%</span>
<span class="c">%   Lp-norm priors</span>
<span class="c">%   --------------</span>
<span class="c">%</span>
<span class="c">%   In order to tune the solution of a convex optimization problem towards</span>
<span class="c">%   the properties we desire, we have to select priors f that</span>
<span class="c">%   promote these properties. In this contribution, we mostly consider</span>
<span class="c">%   priors that are fairly standard in optimization, or simple extensions</span>
<span class="c">%   of such priors. Although their various effects are quite well known,</span>
<span class="c">%   e.g. l_1 optimization favors solutions with a few large values</span>
<span class="c">%   while an l_2 prior favors a more even spread of the energy,</span>
<span class="c">%   considerable limitations are imposed by the duality constraint.</span>
<span class="c">%   Although the set of Gabor dual windows is characterized by the WR</span>
<span class="c">%   equations, their implications in terms of window shape, localization,</span>
<span class="c">%   decay etc. remain largely unexplored. Therefore a short discussion of</span>
<span class="c">%   relevant priors, expected effects and their actual effect in our</span>
<span class="c">%   context seems worthwhile.  </span>
<span class="c">%</span>
<span class="c">%   An l_2 prior will, in our context, always lead to the canonical dual</span>
<span class="c">%   Gabor window. In general, this prior will affect the values in a more</span>
<span class="c">%   proportional way over the whole signal range. It is traditionally used</span>
<span class="c">%   as a data fidelity term, i.e. the solution is expected to be close, in</span>
<span class="c">%   the l_2-norm sense, to a given estimate. The associated objective</span>
<span class="c">%   function is not only convex, but also smooth, admitting gradient</span>
<span class="c">%   descent approaches for minimization.</span>
<span class="c">%</span>
<span class="c">%   Figure 5: Synthesis dual window in time domain minimizing the l2 norm</span>
<span class="c">%</span>
<span class="c">%      If we minimize the two norm of the sythesis window, we recover the</span>
<span class="c">%      canonical dual. Here the original window.</span>
<span class="c">%</span>
<span class="c">%   Figure 6: Synthesis dual window in frequency domain minimizing the l2 norm</span>
<span class="c">%</span>
<span class="c">%      If we minimize the two norm of the sythesis window, we recover the</span>
<span class="c">%      canonical dual.  </span>
<span class="c">%</span>
<span class="c">%   l_1-norm minimization is usually considered, whenever (approximate)</span>
<span class="c">%   sparsity, i.e. a small number of (significant) non-zero values is</span>
<span class="c">%   desired. As the convex relaxation of the l_0 minimization problem, it</span>
<span class="c">%   is equivalent or at least close to sparsity optimization under certain</span>
<span class="c">%   conditions. In general, these conditions are not satisfied by the WR</span>
<span class="c">%   eq. Nevertheless, the restrictions imposed by the WR equations usually</span>
<span class="c">%   allow a solution with few large values. It should be noted however,</span>
<span class="c">%   that small l_1-norm does not imply clustering of the large values,</span>
<span class="c">%   i.e. a solution supported on a short interval. As expected, some</span>
<span class="c">%   concentration is induced by the duality constraint, see the figure</span>
<span class="c">%   bellow. In the presented experiment, the l_1 solution possesses only</span>
<span class="c">%   15 values above -80~dB (relative to the maximum amplitude) on an</span>
<span class="c">%   interval around 0, only half the number of WR equations L a/M=30.</span>
<span class="c">%   However, other configurations have provided solutions with few</span>
<span class="c">%   significant values spread over a larger interval. </span>
<span class="c">%</span>
<span class="c">%   The proximity operator of the ell^1 prior is computed by soft-thresholding:</span>
<span class="c">%   </span>
<span class="c">%          soft_mu(y)  = sign(y) ( |y| - mu )_+</span>
<span class="c">%   </span>
<span class="c">%   where (.)_+=max(.,0 ). For compactly supported windows, a strictly</span>
<span class="c">%   bandlimited dual window is usually not feasible. Therefore, when</span>
<span class="c">%   applied in the Fourier domain, the l_1 prior cannot achieve a truly</span>
<span class="c">%   sparse solution, but promotes a small number of significant values. In</span>
<span class="c">%   many cases, the result is similar to actual concentration measures.</span>
<span class="c">%</span>
<span class="c">%   Figure 7: Synthesis dual window in time domain minimizing the l1 norm</span>
<span class="c">%</span>
<span class="c">%      This window minimize the one norm in time. It tend to have a few</span>
<span class="c">%      big coefficient and all other equal to zero.</span>
<span class="c">%     </span>
<span class="c">%   Figure 8: Synthesis dual window in frequency domain minimizing the l1 norm</span>
<span class="c">%</span>
<span class="c">%      The window spread a lot in frequency. Indeed no optimization is done</span>
<span class="c">%      in this domain.</span>
<span class="c">%</span>
<span class="c">%   Figure 9: Synthesis dual window in time domain minimizing the l1 norm</span>
<span class="c">%</span>
<span class="c">%      We provide a log scale figure.</span>
<span class="c">%</span>
<span class="c">%   Figure 10: Synthesis dual window in time domain minimizing the l1 norm in frequency</span>
<span class="c">%</span>
<span class="c">%      This looks very similar to a smoothness constraint. It is not</span>
<span class="c">%      necessary the case. It is due to the WR equation system.</span>
<span class="c">%</span>
<span class="c">%   Figure 11: Synthesis dual window in frequency domain minimizing the l1 norm in frequency</span>
<span class="c">%</span>
<span class="c">%      The one norm in frequency is minimized. The aglorithm try to</span>
<span class="c">%      sparsify the Fourier transform the window     </span>
<span class="c">%</span>
<span class="c">%   Concentration inducing function</span>
<span class="c">%   -------------------------------</span>
<span class="c">%</span>
<span class="c">%   Our main objective in the following in this contribution will be the search for a</span>
<span class="c">%   Gabor dual window with optimized/modified TF concentration. Therefore</span>
<span class="c">%   we recall a number of different concentration measures. Inspired by the</span>
<span class="c">%   famous Heisenberg inequality, the most natural way to impose</span>
<span class="c">%   localization is to optimize the variance of the signal xin {R}^L or</span>
<span class="c">%   more precisely, its modulus:     </span>
<span class="c">%</span>
<span class="c">%      var(x) = 1/ sqrt(L)  sum_{i=-L/2}^{L/2-1} (i-\bar{|x|})^2 | x_i |</span>
<span class="c">%</span>
<span class="c">%      math: \text{var}(|x|)= 1/\sqrt{L} \sum_{i=-L/2}^{L/2-1}(i-\overline{|x|})^2|x_i|</span>
<span class="c">%</span>
<span class="c">%   with bar{|x|}=sum_{i=-L/2}^{L/2-1}i  X_I  being the center of</span>
<span class="c">%   gravity. As we consider symmetric windows bar{|x|}=0, we can</span>
<span class="c">%   simplify this expression to:  var(|x|)= 1/sqrt{L}</span>
<span class="c">%   sum_{i=-L/2}^{L/2-1}(i)^2  X_I . In that case, the variance turns out</span>
<span class="c">%   to be a weighted l_1-norm with quadratic weight w^2, </span>
<span class="c">%   w := 1 / sqrt{L} [-L/2, ..., L/2-1]. Compared to l_1 minimization, </span>
<span class="c">%   this prior additionally penalizes values far from the origin, inducing</span>
<span class="c">%   concentration. The proximity operator of var(|x|) is a variation of</span>
<span class="c">%   the l_1 proximity operator and computed by weighted soft</span>
<span class="c">%   thresholding. And example is shown in the figure below.</span>
<span class="c">%</span>
<span class="c">%   Figure 12: Synthesis dual window in time domain minimizing the variance it time</span>
<span class="c">%</span>
<span class="c">%      We obtain almost a rectangle</span>
<span class="c">%</span>
<span class="c">%   Figure 13: Synthesis dual window in frequency domain minimizing the variance it time</span>
<span class="c">%</span>
<span class="c">%      </span>
<span class="c">%</span>
<span class="c">%   We also consider the variance of the energy of the signal:</span>
<span class="c">%   var(|x|^2), for symmetric windows equal to a weighted l_2 norm with</span>
<span class="c">%   linear weight w: var(x^2)=||w  x||_2^2. Explicit computation of the</span>
<span class="c">%   proximity operator leads to</span>
<span class="c">%</span>
<span class="c">%      prox_{gamma var(x^2) }(y) = 1 / ( 1 + 2 gamma w^2) * y</span>
<span class="c">%   </span>
<span class="c">%      math: \text{prox}_{\gamma \text{var}(x^2) }(y) = \frac{1}{1+2\gamma w^2} y,</span>
<span class="c">%</span>
<span class="c">%   i.e. multiplication with a function that decays quadratically away from</span>
<span class="c">%   zero. The optimazation result is shown in the figure below.</span>
<span class="c">%</span>
<span class="c">%   Figure 14: Synthesis dual window in time domain minimizing the energy variance it time</span>
<span class="c">%</span>
<span class="c">%      There is also a good concentration in time, but with a kind of</span>
<span class="c">%      smoothness.</span>
<span class="c">%</span>
<span class="c">%   Figure 15: Synthesis dual window in frequency domain minimizing the energy variance it time</span>
<span class="c">%</span>
<span class="c">%      In frequency, we have a better decay compared to the optimization of</span>
<span class="c">%      the variance only.</span>
<span class="c">%</span>
<span class="c">%   A closely related concentration measure is smoothness in frequency, as</span>
<span class="c">%   measured by the gradient of the Fourier transform nabla F</span>
<span class="c">%   x||_2^2. Indeed, the resulting proximity operator has almost the same</span>
<span class="c">%   form: </span>
<span class="c">%   </span>
<span class="c">%      prox_{gamma ||\nabla F x||_2^2 }(y) = 1 / ( 1 + 2 gamma psi) * y</span>
<span class="c">%</span>
<span class="c">%      math \text{prox}_{\gamma \|\nabla \mathcal{F} x\|_2^2 }(y) = \frac{1}{1+2\gamma \psi} y</span>
<span class="c">%</span>
<span class="c">%   with psi[l] = 2-2 cos(2 pi l / L). Since psi[l] approx C l^2</span>
<span class="c">%   for small l and values away from 0 are strongly attenuated, the</span>
<span class="c">%   priors var(|x|^2) and nabla F x||_2^2 often lead to similar</span>
<span class="c">%   results. Both functions induce concentration by attenuation of values</span>
<span class="c">%   far from the origin. Examples are shown in the figure below</span>
<span class="c">%</span>
<span class="c">%   Figure 16: Synthesis dual window in time domain minimizing the gradient of the Fourier transform</span>
<span class="c">%</span>
<span class="c">%      We observe that smoothing the frequencies result in concentrating the</span>
<span class="c">%      window in time.</span>
<span class="c">%</span>
<span class="c">%   Figure 17: Synthesis dual window in frequency domain minimizing the gradient of the Fourier transform</span>
<span class="c">%</span>
<span class="c">%      </span>
<span class="c">%</span>
<span class="c">%   Concentration in frequency is easily achieved through var(|| F x||),</span>
<span class="c">%   var(|| F x ^2) or nabla x||_2^2. The respective proximity</span>
<span class="c">%   operators are obtained simply by conjugating the proximitiy operators</span>
<span class="c">%   discussed above with the (inverse) Fourier transform. The figure are</span>
<span class="c">%   presented bellow.</span>
<span class="c">%</span>
<span class="c">%   Figure 18: Synthesis dual window in time domain minimizing the variance in frequency</span>
<span class="c">%</span>
<span class="c">%      </span>
<span class="c">%</span>
<span class="c">%   Figure 19: Synthesis dual window in frequency domain minimizing the variance in frequency</span>
<span class="c">%</span>
<span class="c">%      </span>
<span class="c">%</span>
<span class="c">%   Figure 20: Synthesis dual window in time domain minimizing the energy variance in frequency</span>
<span class="c">%</span>
<span class="c">%      This is equivalent to smooth the window in time.</span>
<span class="c">%</span>
<span class="c">%   Figure 21: Synthesis dual window in frequency domain minimizing the energy variance in frequency</span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">%   Figure 22: Synthesis dual window in time domain minimizing the gradient in time</span>
<span class="c">%</span>
<span class="c">%      This windows is really smooth. In fact, it is the smoothest dual</span>
<span class="c">%      window for the chosen parameter.</span>
<span class="c">%</span>
<span class="c">%   Figure 23: Synthesis dual window in frequency domain minimizing the gradient in time</span>
<span class="c">%</span>
<span class="c">%      The content in frequency of this windows is more concentrated in</span>
<span class="c">%      low frequency. Indeed, optimizing smoothness concentrate the window</span>
<span class="c">%      in low frequency by applying low pass filters.</span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">%   Simulataneous time/frequency concentration function</span>
<span class="c">%   ---------------------------------------------------</span>
<span class="c">%</span>
<span class="c">%   For simultaneous concentration in time and frequency, we can consider</span>
<span class="c">%   jointly the time- and frequency-domain variants of the priors discussed</span>
<span class="c">%   above. Alternatively, we use a single cost functions providing</span>
<span class="c">%   concentration in both domains at once. In TF literature, modulation</span>
<span class="c">%   space norms, i.e. l_p-norms on the short-time Fourier coefficients</span>
<span class="c">%   are frequently used to measure joint TF localization.. In particular</span>
<span class="c">%   x||_{S_0}=|| G_{g,1,L} x||_1, where g is a Gaussian function, is</span>
<span class="c">%   considered as quality measure for window functions. Minimization of the</span>
<span class="c">%   S_0-norm can be expected to yield TF concentrated windows. However,</span>
<span class="c">%   similar to the ell^1-norm, small S_0-norm does not guarantee</span>
<span class="c">%   concentration around the origin (or any single TF location). As</span>
<span class="c">%   expected, the duality constraint seems to enforce some localization,</span>
<span class="c">%   though. </span>
<span class="c">%</span>
<span class="c">%   Compared to the previously discussed priors, S_0 optimization is</span>
<span class="c">%   considerably more expensive. Since we are not aware of a explicit</span>
<span class="c">%   solution to the S_0 proximity operator, we propose its computation</span>
<span class="c">%   via an iteration based on ADMM. The number</span>
<span class="c">%   of required ADMM steps per PPXA iteration is low and scales well with</span>
<span class="c">%   L (usually 3-4 steps provided sufficient precision), but each substep</span>
<span class="c">%   requires the computation of one full STFT and one inverse STFT, with a</span>
<span class="c">%   complexity of O(L^2 log(L)) each. An example for S_0</span>
<span class="c">%   optimization is shown in the figure below.        </span>
<span class="c">%</span>
<span class="c">%   Figure 24: Synthesis dual window in time domain minimizing the S0 norm</span>
<span class="c">%</span>
<span class="c">%      This window is also well concentrated in time.</span>
<span class="c">%</span>
<span class="c">%   Figure 25: Synthesis dual window in frequency domain minimizing the S0 norm</span>
<span class="c">%</span>
<span class="c">%      A well concentrated windows in frenquency</span>
<span class="c">%</span>
<span class="c">%   In some cases, concentration can be further increased by S_0-norm</span>
<span class="c">%   instead. The proximity operator is realized similar to the unweighted</span>
<span class="c">%   case. The next figures show an example, considering the following</span>
<span class="c">%   circular weights:</span>
<span class="c">%   </span>
<span class="c">%               W[f,t]= ln( 1 + w^2[t] + w^2[f] )</span>
<span class="c">%</span>
<span class="c">%      math: W[f,t]=\ln \left( 1 + w^2[t]+w^2[f] \right),</span>
<span class="c">%   </span>
<span class="c">%   using the weight w as defined above.</span>
<span class="c">%</span>
<span class="c">%   While other weights are clearly feasible, the weight above has been</span>
<span class="c">%   tuned to yield good results in our experiments.</span>
<span class="c">%</span>
<span class="c">%   Figure 26: Synthesis dual window in time domain minimizing a weighted S0 norm</span>
<span class="c">%</span>
<span class="c">%      This window is also well concentrated in time.</span>
<span class="c">%</span>
<span class="c">%   Figure 27: Synthesis dual window in frequency domain minimizing a weighted S0 norm</span>
<span class="c">%</span>
<span class="c">%      A well concentrated windows in frenquency</span>
<span class="c">%</span>
<span class="c">%   Other cost functions</span>
<span class="c">%   --------------------</span>
<span class="c">%</span>
<span class="c">%   The list of possible cost functions is vast and the full exploration of</span>
<span class="c">%   the possibilities of convex optimization in window design is far beyond</span>
<span class="c">%   the scope of any single contribution. As a rather academic example, we</span>
<span class="c">%   propose a free design approach that selects the dual Gabor window</span>
<span class="c">%   closest to the linear span of a model window g_{sh}, i.e. we find     </span>
<span class="c">%</span>
<span class="c">%            argmin || x - P_&lt;g_sh&gt;(x)||_2    such that x is dual</span>
<span class="c">%</span>
<span class="c">%      math:  \mathop{\operatorname{arg~min}}\limits _{x \in \mathcal{C}_{\text{dual}}}\|x - P_{\langle g_{s}\rangle}x\|_2^2,</span>
<span class="c">%</span>
<span class="c">%   where &lt; g_s&gt; is the linear span of g_s. The solution is computed by</span>
<span class="c">%   a POCS (projection onto convex set) algorithm. Due to the examples</span>
<span class="c">%   academic nature, we were not concerned with convergence time. Examples</span>
<span class="c">%   using a sine wave and a dirac pulse as model window are presented in</span>
<span class="c">%   the figure bellow</span>
<span class="c">%</span>
<span class="c">%   Figure 28: Objectiv shape function: a sine</span>
<span class="c">%</span>
<span class="c">%      We choose a sine function as an academic example.</span>
<span class="c">%</span>
<span class="c">%   Figure 29: Synthesis dual window in time domain</span>
<span class="c">%</span>
<span class="c">%      This window looks like a sine and it is still dual. </span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">%   Figure 30: Shape objectiv function: a dirac</span>
<span class="c">%</span>
<span class="c">%      We choose a dirac function. Why not?</span>
<span class="c">%</span>
<span class="c">%   Figure 31: Synthesis dual window in time domain</span>
<span class="c">%</span>
<span class="c">%      This window looks a bit like a dirac and it is still dual. </span>
<span class="c">%</span>
<span class="c">%   Figure 32: Synthesis dual window in time domain (zoom in)</span>
<span class="c">%</span>
<span class="c">%      Note that the solution window (d) is actually composed of a smooth</span>
<span class="c">%      bump function in addition to the 3 clearly visible impulses. </span>
<span class="c">%</span>
<span class="c">%</span>
<span class="c">%   Url: https://epfl-lts2.github.io/rrp-html/gdwuco/rr_gaboptdual.html</span>

<span class="c">% Copyright (C) 2012-2013 Nathanael Perraudin.</span>
<span class="c">% This file is part of RRP version 0.2</span>
<span class="c">%</span>
<span class="c">% This program is free software: you can redistribute it and/or modify</span>
<span class="c">% it under the terms of the GNU General Public License as published by</span>
<span class="c">% the Free Software Foundation, either version 3 of the License, or</span>
<span class="c">% (at your option) any later version.</span>
<span class="c">%</span>
<span class="c">% This program is distributed in the hope that it will be useful,</span>
<span class="c">% but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c">% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c">% GNU General Public License for more details.</span>
<span class="c">%</span>
<span class="c">% You should have received a copy of the GNU General Public License</span>
<span class="c">% along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>



<span class="c">%   Author : Nathanael Perraudin</span>
<span class="c">%   Date   : Feb 24 2013</span>




<span class="c">%% initialization</span>
<span class="c">%clear all;</span>
<span class="n">close</span> <span class="n">all</span><span class="p">;</span>


<span class="k">global</span> <span class="n">GLOBAL_save</span>
<span class="k">global</span> <span class="n">GLOBAL_baw</span>
<span class="k">global</span> <span class="n">GLOBAL_evolution</span>
 

<span class="c">% plotting</span>
<span class="n">dr</span><span class="p">=</span><span class="mi">100</span><span class="p">;</span>
<span class="k">if</span> <span class="n">GLOBAL_baw</span>
    <span class="n">paramplot</span><span class="p">.</span><span class="n">pathfigure</span> <span class="p">=</span> <span class="s">&#39;figures/gaboptdual/&#39;</span><span class="p">;</span> 
<span class="k">else</span>
    <span class="n">paramplot</span><span class="p">.</span><span class="n">pathfigure</span> <span class="p">=</span> <span class="s">&#39;figures_color/gaboptdual/&#39;</span><span class="p">;</span> 
<span class="k">end</span>
    
<span class="n">paramplot</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">100</span> <span class="mi">300</span> <span class="mi">200</span><span class="p">];</span>
<span class="n">paramplot</span><span class="p">.</span><span class="n">titleweight</span> <span class="p">=</span><span class="s">&#39;bold&#39;</span><span class="p">;</span>
<span class="n">paramplot</span><span class="p">.</span><span class="n">save</span> <span class="p">=</span> <span class="n">GLOBAL_save</span><span class="p">;</span> <span class="c">% save figures</span>
<span class="n">paramplot</span><span class="p">.</span><span class="n">baw</span> <span class="p">=</span> <span class="n">GLOBAL_baw</span><span class="p">;</span> <span class="c">% plot everything in black and white</span>

<span class="n">evo</span> <span class="p">=</span> <span class="n">GLOBAL_evolution</span><span class="p">;</span>

<span class="c">%%</span>

<span class="c">% general parameter</span>
<span class="n">maxit</span><span class="p">=</span><span class="mi">200</span><span class="p">;</span> <span class="c">% maximum number of iteration</span>
<span class="n">tol</span><span class="p">=</span><span class="mf">10e-6</span><span class="p">;</span> <span class="c">% tolerance to stop iterating</span>

<span class="c">% parameters of frame and length</span>
<span class="n">a</span><span class="p">=</span><span class="mi">15</span><span class="p">;</span>
<span class="n">M</span><span class="p">=</span><span class="mi">120</span><span class="p">;</span>
<span class="n">L</span><span class="p">=</span><span class="mi">240</span><span class="p">;</span>

<span class="c">% windows</span>
<span class="n">g</span><span class="p">=</span><span class="n">firwin</span><span class="p">(</span><span class="s">&#39;itersine&#39;</span><span class="p">,</span><span class="mi">60</span><span class="p">);</span>
<span class="c">%g = fftshift(tukeywin(60,.6));</span>

<span class="n">g</span><span class="p">=</span><span class="n">fir2long</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">L</span><span class="p">);</span>



<span class="c">% original window</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(a)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;analysis_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(b)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;analysis_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>


<span class="c">% canonical dual</span>
<span class="n">gcan</span><span class="p">=</span><span class="n">gabdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">);</span>
<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gcan</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c`)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;can_dual_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>


<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gcan</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c`)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;can_dual_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>



<span class="c">%% Convex optimization L2 norm constraint</span>

<span class="c">%parameter for convex optimization</span>

<span class="n">omega</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span> <span class="c">% weight for the L2 norm</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>

<span class="n">drawnow</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: L2 norm\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;omega&#39;</span><span class="p">,</span><span class="n">omega</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Equal to the canonical dual? norm(gd-gcan) = %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">gd</span><span class="o">-</span><span class="n">gcan</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c&quot;)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;l2_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c&quot;)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;l2_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>



<span class="c">%% Convex optimization L1 norm in time</span>

<span class="c">%parameter for convex optimization</span>
<span class="n">alpha</span><span class="p">=</span><span class="mf">0.01</span><span class="p">;</span><span class="c">% weight of the L1 norm in time</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">drawnow</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: L1 time\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;alpha&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="mf">0.0001</span><span class="o">*</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;constant&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;l1_time&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">6</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">6</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(a)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;l1time_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(b)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;l1time_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(a&quot;)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">=</span><span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">off</span><span class="p">;</span>
<span class="n">semilogy</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">gd</span><span class="p">)));</span>
<span class="n">ylim</span><span class="p">([</span><span class="mf">1e-10</span> <span class="mi">10</span><span class="o">*</span><span class="n">max</span><span class="p">(</span><span class="n">gd</span><span class="p">)]);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;l1time_time_log&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="c">%%</span>
<span class="c">% try to set to 0 coefficient below a certain threshold</span>
<span class="n">thresh</span><span class="p">=</span><span class="mi">80</span><span class="p">;</span> <span class="c">%threshlod in dB</span>
<span class="n">t</span><span class="p">=</span><span class="n">max</span><span class="p">(</span><span class="n">gd</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span>^<span class="p">(</span><span class="o">-</span><span class="n">thresh</span><span class="o">/</span><span class="mi">10</span><span class="p">);</span>
<span class="n">gd</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gd</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t</span><span class="p">)=</span><span class="mi">0</span><span class="p">;</span>    <span class="c">%thresholding</span>

<span class="c">% Compute reconstruciton error, number of non zeros coefficients and length</span>
<span class="c">% of support</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of the window after a threshold of %i dB: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">thresh</span><span class="p">,</span><span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Percent of non-zeros coefficients: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nb">length</span><span class="p">(</span><span class="n">gd</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Number of non-zeros coefficients: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">));</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Percent of non-zeros for the cannonical dual: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gcan</span><span class="p">)</span><span class="o">&gt;</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="nb">length</span><span class="p">(</span><span class="n">gd</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">);</span>

<span class="c">% length of the support</span>
<span class="n">nz</span><span class="p">=</span><span class="n">fftshift</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gd</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span>
<span class="n">indi</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;first&#39;</span><span class="p">);</span>
<span class="n">indf</span> <span class="p">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;last&#39;</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Length of the support: %i\n&#39;</span><span class="p">,</span><span class="n">indf</span><span class="o">-</span><span class="n">indi</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>

<span class="c">%% Convex optimization L1 norm in frequency</span>

<span class="c">%parameter for convex optimization</span>

<span class="nb">beta</span><span class="p">=</span><span class="mf">0.001</span><span class="p">;</span> <span class="c">% weight of the L1 norm in frequency</span>

<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>

<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: L1 frequency\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="nb">beta</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="mf">0.01</span><span class="o">*</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;constant&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;l1_freq&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">7</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">7</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;l1freq_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(d)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;l1freq_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="c">%% Convex optimization Variance in time</span>

<span class="c">%parameter for convex optimization</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">vart</span><span class="p">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">;</span>
<span class="n">drawnow</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: Variance in time\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;vart&#39;</span><span class="p">,</span><span class="n">vart</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="mf">0.1</span><span class="o">*</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;dynamic&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;var_time&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">8</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">8</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(a)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;vart_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(b)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;vart_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>


<span class="c">%% Convex optimization: Energy variance in time</span>

<span class="c">%parameter for convex optimization</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">var2t</span><span class="p">=</span><span class="mi">10</span><span class="p">;</span>
<span class="n">drawnow</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: Energy variance in time\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;var2t&#39;</span><span class="p">,</span><span class="n">var2t</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;constant&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;var2_time&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">10</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">10</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;var2t_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(d)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;var2t_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="c">%% Convex optimization concentration in time</span>

<span class="c">%parameter for convex optimization</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">100</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">drawnow</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: Concentration in time\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;dynamic&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;grad_freq&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">3</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(e)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;smoothfreq_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(f)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;smoothfreq_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="n">gd_time</span><span class="p">=</span><span class="n">gd</span><span class="p">;</span>

<span class="c">%% Convex optimization Variance in frequency</span>

<span class="c">%parameter for convex optimization</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">varf</span><span class="p">=</span><span class="mi">8</span><span class="o">/</span><span class="mi">100</span><span class="p">;</span>
<span class="n">drawnow</span><span class="p">;</span>

<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: Variance in frequency\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;varf&#39;</span><span class="p">,</span><span class="n">varf</span><span class="p">,</span><span class="c">...</span>
   <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="mf">0.01</span><span class="o">*</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;dynamic&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;var_freq&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">9</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">9</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(a)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;varf_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(b)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;varf_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>


<span class="c">%% Convex optimization: Energy variance in frequency</span>

<span class="c">%parameter for convex optimization</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">var2f</span><span class="p">=</span><span class="mi">10</span><span class="p">;</span>
<span class="n">drawnow</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: Energy variance in frequency\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;var2f&#39;</span><span class="p">,</span><span class="n">var2f</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;constant&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;var2_freq&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">11</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">11</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;var2f_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(d)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;var2f_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="c">%% Convex optimization smoothness constraint</span>

<span class="c">%parameter for convex optimization</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">1000</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>

<span class="n">drawnow</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: smoothness constraint\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;dynamic&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;grad_time&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>
<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(e)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;smoothtime_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(f)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;smoothtime_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="n">gd_freq</span><span class="p">=</span><span class="n">gd</span><span class="p">;</span>

<span class="c">%% Convex optimization S0 norm</span>

<span class="c">%parameter for convex optimization</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">delta</span><span class="p">=</span><span class="mf">0.005</span><span class="p">;</span>

<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: S0 norm\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;delta&#39;</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;quiet&#39;</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;dynamic&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;S0&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">4</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">4</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(a)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;S0_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(b)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;S0_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="c">%% Convex optimization weighted S0 norm</span>


<span class="c">%parameter for convex optimization</span>
<span class="n">mu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>      <span class="c">% smoothing parameter</span>
<span class="nb">gamma</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span> <span class="c">% weight for the concentration in time</span>
<span class="n">deltaw</span><span class="p">=</span><span class="mf">0.005</span><span class="p">;</span>

<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: S0 norm\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gaboptdual</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;mu&#39;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s">&#39;gamma&#39;</span><span class="p">,</span><span class="nb">gamma</span><span class="p">,</span><span class="s">&#39;deltaw&#39;</span><span class="p">,</span><span class="n">deltaw</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="n">maxit</span><span class="p">,</span><span class="s">&#39;tol&#39;</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="s">&#39;quiet&#39;</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">,</span><span class="s">&#39;dynamic&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;S0_weighted&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="p">[</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">5</span><span class="p">,:),</span><span class="n">crit_mat2</span><span class="p">(</span><span class="mi">5</span><span class="p">,:)]</span> <span class="p">=</span> <span class="n">compute_criteria</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>

<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;weighted_S0_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">magresp</span><span class="p">(</span><span class="n">gd</span><span class="p">,</span><span class="s">&#39;fir&#39;</span><span class="p">,</span><span class="s">&#39;dynrange&#39;</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(d)&#39;</span><span class="p">);</span>
<span class="n">setplotfreq</span><span class="p">();</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;weighted_S0_freq&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>



<span class="c">%% Convex optimization L2 - sine like</span>

<span class="n">glike</span><span class="p">=</span><span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">L</span><span class="p">]</span><span class="o">&#39;/</span><span class="n">L</span><span class="p">);</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: sine like\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gabglike</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">glike</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;sine_like&#39;</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% [crit_mat(12,:),crit_mat2(12,:)] = compute_criteria(gd);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>
<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">fir2long</span><span class="p">(</span><span class="n">glike</span><span class="p">,</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">gcan</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">glike</span><span class="p">));</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(a)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;sine_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(b)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;sinelike_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="c">%% Convex optimization L2 - dirac like</span>

<span class="n">glike</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">g</span><span class="p">));</span>
<span class="n">glike</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="c">% solving the problem</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39; Solve the convex optimization problem: dirac like\n&#39;</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="n">gabglike</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">glike</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;maxit&#39;</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;dirac_like&#39;</span><span class="p">,</span><span class="s">&#39;evolution&#39;</span><span class="p">,</span><span class="n">evo</span><span class="p">);</span>
<span class="n">gd</span><span class="p">=</span><span class="nb">real</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>

<span class="c">% [crit_mat(13,:),crit_mat2(13,:)] = compute_criteria(gd);</span>

<span class="c">% Verification: this number should be close to 0.</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;  Reconstruction error of optimization problem: %g \n&#39;</span><span class="p">,</span><span class="c">...</span>
    <span class="n">gabdualnorm</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gd</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>
<span class="n">figure</span><span class="p">();</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">fir2long</span><span class="p">(</span><span class="n">glike</span><span class="p">,</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">gcan</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">glike</span><span class="p">));</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(c)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;dirac_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>
<span class="n">figure</span><span class="p">()</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(d)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;diraclike_time&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">plot_time</span><span class="p">(</span><span class="n">gd</span><span class="p">);</span>
<span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">max</span><span class="p">(</span><span class="n">gcan</span><span class="p">),</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">max</span><span class="p">(</span><span class="n">gcan</span><span class="p">)]);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;(d`)&#39;</span><span class="p">);</span>
<span class="n">save_name</span><span class="p">=</span><span class="s">&#39;diraclike_time_zoom&#39;</span><span class="p">;</span>
<span class="n">plotfig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span><span class="n">paramplot</span> <span class="p">);</span>


<span class="c">%%</span>

<span class="n">Y</span> <span class="p">=</span> <span class="p">(</span><span class="n">crit_mat</span> <span class="o">-</span> <span class="nb">repmat</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">crit_mat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">,:)),</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span> <span class="n">Y</span> <span class="p">=</span> <span class="n">Y</span><span class="o">./</span><span class="nb">repmat</span><span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">,:)),</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Y</span>

<span class="n">crit_mat2</span>
</pre></div>


            </div>
        </div>

        <div class="include" file="../include/footer.html"></div>
    </div>
</div>
<!-- These two have to be here to dynamically load the included parts -->
<script src="../include/jquery.min.js"></script>
<script src="../include/bootstrap-select.min.js"></script>
<script src="../include/rrp.js" type="text/javascript"></script>
</body>
</html>




